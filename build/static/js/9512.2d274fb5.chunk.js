"use strict";(self.webpackChunkmantis_material_react=self.webpackChunkmantis_material_react||[]).push([[9512],{79512:function(e,n,i){i.r(n),i.d(n,{default:function(){return L}});var r=i(1413),t=i(58467),s=i(19860),d=i(9019),o=i(42832),l=i(15103),c=i(1550),a=i(24631),u=i(88797),h=i(57829),x=i(51405),m=i(15480),j=i(61113),Z=i(24193),v=i(51629),p=i(66835),f=i(23477),g=i(24076),y=i(70941),I=i(57861),_=i(19536),b=i(48182),C=i(23208),P=i(63686),w=i(91208),q=i(21933),A=i(12549),M=i(89600),S=i(35604),O=i(15914),k=i(48209),D=i(7901),N=i(98271),F=function(e){var n=e.toString(),i=null===n.match(/\d+/)?0:n.match(/\d+/)[0],r=i.length;for(i=(parseInt(i)+1).toString();i.length<r;)i="0"+i;return n.replace(/[0-9]/g,"").concat(i)},T=i(22150),R=i(18530),U=i(88464),B=i(12019),H=i(82138),z=i(46417),V=q.Ry({date:q.hT().required("Invoice date is required"),due_date:q.hT().when("date",(function(e,n){return e&&n.min(e,"Due date can't be before invoice date")})).nullable().required("Due date is required"),customerInfo:q.Ry({name:q.Z_().required("Invoice receiver information is required")}).required("Invoice receiver information is required"),status:q.Z_().required("Status selection is required"),invoice_detail:q.IX().required("Invoice details is required").of(q.Ry().shape({name:q.Z_().required("Product name is required")})).min(1,"Invoice must have at least 1 items")}),L=function(){var e=(0,s.Z)(),n=(0,T.I0)(),i=(0,T.v9)((function(e){return e.invoice})),q=i.open,L=i.isCustomerOpen,W=i.countries,E=i.country,J=i.lists,K=i.isOpen,G=(0,t.s0)(),Q=function(){n((0,U.UA)({isOpen:!1}))};return(0,z.jsx)(O.Z,{children:(0,z.jsx)(S.J9,{initialValues:{id:120,invoice_id:Date.now(),status:"",date:new Date,due_date:null,cashierInfo:{name:"Belle J. Richter",address:"1300 Cooks Mine, NM 87829",phone:"305-829-7809",email:"belljrc23@gmail.com"},customerInfo:{address:"",email:"",name:"",phone:""},invoice_detail:[{id:(0,A.Z)(),name:"",description:"",qty:1,price:"1.00"}],discount:0,tax:0,notes:""},validationSchema:V,onSubmit:function(e){!function(e){var i,r,t,s={id:Number(F(J.length)),invoice_id:Number(e.invoice_id),customer_name:null===(i=e.cashierInfo)||void 0===i?void 0:i.name,email:null===(r=e.cashierInfo)||void 0===r?void 0:r.email,avatar:Number(Math.round(10*Math.random())),discount:Number(e.discount),tax:Number(e.tax),date:(0,M.Z)(e.date,"MM/dd/yyyy"),due_date:(0,M.Z)(e.due_date,"MM/dd/yyyy"),quantity:Number(null===(t=e.invoice_detail)||void 0===t?void 0:t.reduce((function(e,n){return e+n.qty}),0)),status:e.status,cashierInfo:e.cashierInfo,customerInfo:e.customerInfo,invoice_detail:e.invoice_detail,notes:e.notes};n((0,U.wc)()).then((function(){n((0,U.q7)(s)).then((function(){n((0,R.ss)({open:!0,message:"Invoice Added successfully",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"alert",alert:{color:"success"},close:!1})),G("/apps/invoice/list")}))}))}(e)},children:function(i){var t,s,M,F,T,R,V,J,G,X=i.handleBlur,Y=i.errors,$=i.handleChange,ee=i.handleSubmit,ne=i.values,ie=i.isValid,re=i.setFieldValue,te=i.touched,se=null===ne||void 0===ne?void 0:ne.invoice_detail.reduce((function(e,n){return n.name.trim().length>0?e+Number(n.price*Math.floor(n.qty)):e}),0),de=ne.tax*se/100,oe=ne.discount*se/100,le=se-oe+de;return(0,z.jsx)(S.l0,{onSubmit:ee,children:(0,z.jsxs)(d.ZP,{container:!0,spacing:2,children:[(0,z.jsx)(d.ZP,{item:!0,xs:12,sm:6,md:3,children:(0,z.jsxs)(o.Z,{spacing:1,children:[(0,z.jsx)(l.Z,{children:"Invoice Id"}),(0,z.jsx)(c.Z,{sx:{width:"100%"},children:(0,z.jsx)(a.Z,{required:!0,disabled:!0,type:"number",name:"invoice_id",id:"invoice_id",value:ne.invoice_id,onChange:$})})]})}),(0,z.jsxs)(d.ZP,{item:!0,xs:12,sm:6,md:3,children:[(0,z.jsxs)(o.Z,{spacing:1,children:[(0,z.jsx)(l.Z,{children:"Status"}),(0,z.jsx)(c.Z,{sx:{width:"100%"},children:(0,z.jsxs)(u.Z,{value:ne.status,displayEmpty:!0,name:"status",renderValue:function(e){return 0===e.length?(0,z.jsx)(h.Z,{sx:{color:"secondary.400"},children:"Select status"}):e},onChange:$,error:Boolean(Y.status&&te.status),children:[(0,z.jsx)(x.Z,{disabled:!0,value:"",children:"Select status"}),(0,z.jsx)(x.Z,{value:"Paid",children:"Paid"}),(0,z.jsx)(x.Z,{value:"Unpaid",children:"Unpaid"}),(0,z.jsx)(x.Z,{value:"Cancelled",children:"Cancelled"})]})})]}),te.status&&Y.status&&(0,z.jsx)(m.Z,{error:!0,children:Y.status})]}),(0,z.jsxs)(d.ZP,{item:!0,xs:12,sm:6,md:3,children:[(0,z.jsxs)(o.Z,{spacing:1,children:[(0,z.jsx)(l.Z,{children:"Date"}),(0,z.jsx)(c.Z,{sx:{width:"100%"},error:Boolean(te.date&&Y.date),children:(0,z.jsx)(C._,{dateAdapter:w.H,children:(0,z.jsx)(P.M,{format:"dd/MM/yyyy",value:ne.date,onChange:function(e){return re("date",e)}})})})]}),te.date&&Y.date&&(0,z.jsx)(m.Z,{error:!0,children:Y.date})]}),(0,z.jsxs)(d.ZP,{item:!0,xs:12,sm:6,md:3,children:[(0,z.jsxs)(o.Z,{spacing:1,children:[(0,z.jsx)(l.Z,{children:"Due Date"}),(0,z.jsx)(c.Z,{sx:{width:"100%"},error:Boolean(te.due_date&&Y.due_date),children:(0,z.jsx)(C._,{dateAdapter:w.H,children:(0,z.jsx)(P.M,{format:"dd/MM/yyyy",value:ne.due_date,onChange:function(e){return re("due_date",e)}})})})]}),te.due_date&&Y.due_date&&(0,z.jsx)(m.Z,{error:!0,children:Y.due_date})]}),(0,z.jsx)(d.ZP,{item:!0,xs:12,sm:6,children:(0,z.jsx)(O.Z,{sx:{minHeight:168},children:(0,z.jsxs)(d.ZP,{container:!0,spacing:2,children:[(0,z.jsx)(d.ZP,{item:!0,xs:12,sm:8,children:(0,z.jsxs)(o.Z,{spacing:2,children:[(0,z.jsx)(j.Z,{variant:"h5",children:"From:"}),(0,z.jsxs)(o.Z,{sx:{width:"100%"},children:[(0,z.jsx)(j.Z,{variant:"subtitle1",children:null===ne||void 0===ne||null===(t=ne.cashierInfo)||void 0===t?void 0:t.name}),(0,z.jsx)(j.Z,{color:"secondary",children:null===ne||void 0===ne||null===(s=ne.cashierInfo)||void 0===s?void 0:s.address}),(0,z.jsx)(j.Z,{color:"secondary",children:null===ne||void 0===ne||null===(M=ne.cashierInfo)||void 0===M?void 0:M.phone}),(0,z.jsx)(j.Z,{color:"secondary",children:null===ne||void 0===ne||null===(F=ne.cashierInfo)||void 0===F?void 0:F.email})]})]})}),(0,z.jsx)(d.ZP,{item:!0,xs:12,sm:4,children:(0,z.jsxs)(h.Z,{textAlign:{xs:"left",sm:"right"},color:"grey.200",children:[(0,z.jsx)(Z.Z,{variant:"outlined",startIcon:(0,z.jsx)(B.Z,{}),color:"secondary",onClick:function(){return n((0,U.Uj)({open:!0}))},size:"small",children:"Change"}),(0,z.jsx)(D.Z,{open:q,setOpen:function(e){return n((0,U.Uj)({open:e}))},handlerAddress:function(e){return re("cashierInfo",e)}})]})})]})})}),(0,z.jsxs)(d.ZP,{item:!0,xs:12,sm:6,children:[(0,z.jsx)(O.Z,{sx:{minHeight:168},children:(0,z.jsxs)(d.ZP,{container:!0,spacing:2,children:[(0,z.jsx)(d.ZP,{item:!0,xs:12,sm:8,children:(0,z.jsxs)(o.Z,{spacing:2,children:[(0,z.jsx)(j.Z,{variant:"h5",children:"To:"}),(0,z.jsxs)(o.Z,{sx:{width:"100%"},children:[(0,z.jsx)(j.Z,{variant:"subtitle1",children:null===ne||void 0===ne||null===(T=ne.customerInfo)||void 0===T?void 0:T.name}),(0,z.jsx)(j.Z,{color:"secondary",children:null===ne||void 0===ne||null===(R=ne.customerInfo)||void 0===R?void 0:R.address}),(0,z.jsx)(j.Z,{color:"secondary",children:null===ne||void 0===ne||null===(V=ne.customerInfo)||void 0===V?void 0:V.phone}),(0,z.jsx)(j.Z,{color:"secondary",children:null===ne||void 0===ne||null===(J=ne.customerInfo)||void 0===J?void 0:J.email})]})]})}),(0,z.jsx)(d.ZP,{item:!0,xs:12,sm:4,children:(0,z.jsxs)(h.Z,{textAlign:"right",color:"grey.200",children:[(0,z.jsx)(Z.Z,{size:"small",startIcon:(0,z.jsx)(H.Z,{}),color:"secondary",variant:"outlined",onClick:function(){return n((0,U.gK)({isCustomerOpen:!0}))},children:"Add"}),(0,z.jsx)(D.Z,{open:L,setOpen:function(e){return n((0,U.gK)({isCustomerOpen:e}))},handlerAddress:function(e){return re("customerInfo",e)}})]})})]})}),te.customerInfo&&Y.customerInfo&&(0,z.jsx)(m.Z,{error:!0,children:null===Y||void 0===Y||null===(G=Y.customerInfo)||void 0===G?void 0:G.name})]}),(0,z.jsx)(d.ZP,{item:!0,xs:12,children:(0,z.jsx)(j.Z,{variant:"h5",children:"Detail"})}),(0,z.jsx)(d.ZP,{item:!0,xs:12,children:(0,z.jsx)(S.F2,{name:"invoice_detail",render:function(n){var i,r=n.remove,t=n.push;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(v.Z,{children:(0,z.jsxs)(p.Z,{sx:{minWidth:650},children:[(0,z.jsx)(f.Z,{children:(0,z.jsxs)(g.Z,{children:[(0,z.jsx)(y.Z,{children:"#"}),(0,z.jsx)(y.Z,{children:"Name"}),(0,z.jsx)(y.Z,{children:"Description"}),(0,z.jsx)(y.Z,{children:"Qty"}),(0,z.jsx)(y.Z,{children:"Price"}),(0,z.jsx)(y.Z,{align:"right",children:"Amount"}),(0,z.jsx)(y.Z,{align:"right",children:"Action"})]})}),(0,z.jsx)(I.Z,{children:null===(i=ne.invoice_detail)||void 0===i?void 0:i.map((function(e,n){return(0,z.jsxs)(g.Z,{children:[(0,z.jsx)(y.Z,{children:ne.invoice_detail.indexOf(e)+1}),(0,z.jsx)(k.Z,{id:e.id,index:n,name:e.name,description:e.description,qty:e.qty,price:e.price,onDeleteItem:function(e){return r(e)},onEditItem:$,Blur:X,errors:Y,touched:te},e.id)]},e.id)}))})]})}),(0,z.jsx)(_.Z,{}),te.invoice_detail&&Y.invoice_detail&&!Array.isArray(null===Y||void 0===Y?void 0:Y.invoice_detail)&&(0,z.jsx)(o.Z,{direction:"row",justifyContent:"center",sx:{p:1.5},children:(0,z.jsx)(m.Z,{error:!0,children:Y.invoice_detail})}),(0,z.jsxs)(d.ZP,{container:!0,justifyContent:"space-between",children:[(0,z.jsx)(d.ZP,{item:!0,xs:12,md:8,children:(0,z.jsx)(h.Z,{sx:{pt:2.5,pr:2.5,pb:2.5,pl:0},children:(0,z.jsx)(Z.Z,{color:"primary",startIcon:(0,z.jsx)(H.Z,{}),onClick:function(){return t({id:(0,A.Z)(),name:"",description:"",qty:1,price:"1.00"})},variant:"dashed",sx:{bgcolor:"transparent !important"},children:"Add Item"})})}),(0,z.jsxs)(d.ZP,{item:!0,xs:12,md:4,children:[(0,z.jsxs)(d.ZP,{container:!0,justifyContent:"space-between",spacing:2,sx:{pt:2.5,pb:2.5},children:[(0,z.jsx)(d.ZP,{item:!0,xs:6,children:(0,z.jsxs)(o.Z,{spacing:1,children:[(0,z.jsx)(l.Z,{children:"Discount(%)"}),(0,z.jsx)(a.Z,{type:"number",fullWidth:!0,name:"discount",id:"discount",placeholder:"0.0",value:ne.discount,onChange:$,inputProps:{min:0}})]})}),(0,z.jsx)(d.ZP,{item:!0,xs:6,children:(0,z.jsxs)(o.Z,{spacing:1,children:[(0,z.jsx)(l.Z,{children:"Tax(%)"}),(0,z.jsx)(a.Z,{type:"number",fullWidth:!0,name:"tax",id:"tax",placeholder:"0.0",value:ne.tax,onChange:$,inputProps:{min:0}})]})})]}),(0,z.jsx)(d.ZP,{item:!0,xs:12,children:(0,z.jsxs)(o.Z,{spacing:2,children:[(0,z.jsxs)(o.Z,{direction:"row",justifyContent:"space-between",children:[(0,z.jsx)(j.Z,{color:e.palette.grey[500],children:"Sub Total:"}),(0,z.jsx)(j.Z,{children:(null===E||void 0===E?void 0:E.prefix)+""+se.toFixed(2)})]}),(0,z.jsxs)(o.Z,{direction:"row",justifyContent:"space-between",children:[(0,z.jsx)(j.Z,{color:e.palette.grey[500],children:"Discount:"}),(0,z.jsx)(j.Z,{variant:"h6",color:e.palette.success.main,children:(null===E||void 0===E?void 0:E.prefix)+""+oe.toFixed(2)})]}),(0,z.jsxs)(o.Z,{direction:"row",justifyContent:"space-between",children:[(0,z.jsx)(j.Z,{color:e.palette.grey[500],children:"Tax:"}),(0,z.jsx)(j.Z,{children:(null===E||void 0===E?void 0:E.prefix)+""+de.toFixed(2)})]}),(0,z.jsxs)(o.Z,{direction:"row",justifyContent:"space-between",children:[(0,z.jsx)(j.Z,{variant:"subtitle1",children:"Grand Total:"}),(0,z.jsx)(j.Z,{variant:"subtitle1",children:le%1===0?(null===E||void 0===E?void 0:E.prefix)+""+le:(null===E||void 0===E?void 0:E.prefix)+""+le.toFixed(2)})]})]})})]})]})]})}})}),(0,z.jsx)(d.ZP,{item:!0,xs:12,children:(0,z.jsxs)(o.Z,{spacing:1,children:[(0,z.jsx)(l.Z,{children:"Notes"}),(0,z.jsx)(a.Z,{placeholder:"Address",rows:3,value:ne.notes,multiline:!0,name:"notes",onChange:$,inputProps:{maxLength:500},helperText:"".concat(ne.notes.length," / ").concat(500),sx:{width:"100%","& .MuiFormHelperText-root":{mr:0,display:"flex",justifyContent:"flex-end"}}})]})}),(0,z.jsx)(d.ZP,{item:!0,xs:12,sm:6,children:(0,z.jsxs)(o.Z,{spacing:1,children:[(0,z.jsx)(l.Z,{children:"Set Currency*"}),(0,z.jsx)(c.Z,{sx:{width:{xs:"100%",sm:250}},children:(0,z.jsx)(b.Z,{id:"country-select-demo",fullWidth:!0,options:W,defaultValue:W[2],value:W.find((function(e){return e.code===(null===E||void 0===E?void 0:E.code)})),onChange:function(e,i){n((0,U.C2)({country:i}))},autoHighlight:!0,getOptionLabel:function(e){return e.label},renderOption:function(e,n){return(0,z.jsxs)(h.Z,(0,r.Z)((0,r.Z)({component:"li",sx:{"& > img":{mr:2,flexShrink:0}}},e),{},{children:[n.code&&(0,z.jsx)("img",{loading:"lazy",width:"20",src:"https://flagcdn.com/w20/".concat(n.code.toLowerCase(),".png"),alt:""}),n.label]}))},renderInput:function(e){var n=W.find((function(e){return e.code===(null===E||void 0===E?void 0:E.code)}));return(0,z.jsx)(a.Z,(0,r.Z)((0,r.Z)({},e),{},{name:"phoneCode",placeholder:"Select",InputProps:(0,r.Z)((0,r.Z)({},e.InputProps),{},{startAdornment:(0,z.jsx)(z.Fragment,{children:n&&""!==n.code&&(0,z.jsx)("img",{style:{marginRight:6},loading:"lazy",width:"20",src:"https://flagcdn.com/w20/".concat(n.code.toLowerCase(),".png"),alt:""})})}),inputProps:(0,r.Z)((0,r.Z)({},e.inputProps),{},{autoComplete:"new-password"})}))}})})]})}),(0,z.jsx)(d.ZP,{item:!0,xs:12,sm:6,children:(0,z.jsxs)(o.Z,{direction:"row",justifyContent:"flex-end",alignItems:"flex-end",spacing:2,sx:{height:"100%"},children:[(0,z.jsx)(Z.Z,{variant:"outlined",color:"secondary",disabled:""===ne.status||!ie,sx:{color:"secondary.dark"},onClick:function(){return n((0,U.UA)({isOpen:!0}))},children:"Preview"}),(0,z.jsx)(Z.Z,{variant:"outlined",color:"secondary",sx:{color:"secondary.dark"},children:"Save"}),(0,z.jsx)(Z.Z,{color:"primary",variant:"contained",type:"submit",children:"Create & Send"}),(0,z.jsx)(N.Z,{isOpen:K,setIsOpen:function(e){return n((0,U.UA)({isOpen:e}))},invoiceInfo:(0,r.Z)((0,r.Z)({},ne),{},{subtotal:se,taxRate:de,discountRate:oe,total:le}),items:null===ne||void 0===ne?void 0:ne.invoice_detail,onAddNextInvoice:Q},ne.invoice_id)]})})]})})}})})}}}]);